<!DOCTYPE HTML>
<html>
<head>
<link rel="stylesheet" type="text/css" href="example.css">
<style>
td {
  height: 30px;
  text-align: center;
}
* {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
#destination {
  width: 50%;
  float: left;
}
#studentTable {
  width: 50%;
  float: right;
}
</style>
<script src="studentList.json"></script>
<script>
var maxColumns = 3;
function allowDrop(ev) {
    ev.preventDefault();
}

function drag(ev) {
    ev.dataTransfer.setData("text/html", ev.target.id);
}
function countUndecided(){
  studentTable = document.getElementById("studentTable");
  undecided = document.getElementById("undecided");
  count = document.getElementsByClassName("undecided").length;
  // console.log(count);
  undecided.innerHTML = count.toString();
}
function updateTotals(){
	var destinationTable = document.getElementById('destination');
  countUndecided();
	for (i = 0; i < destinationTable.rows[0].cells.length;i++){
		//console.log(i);
		var tdcount = destinationTable.rows[1].cells[i].childElementCount;
		var totaltd = destinationTable.rows[2].cells[i];
		totaltd.innerHTML = tdcount.toString();
		// console.log(totaltd);
	}

}
function drop(ev) {
    ev.preventDefault();
    ev.stopPropagation();
     var data = ev.dataTransfer.getData("text/html");
    ev.target.appendChild(document.getElementById(data));
    document.getElementById(data).setAttribute("class","");
    console.log(document.getElementById(data).id);
    studentTable = document.getElementById("studentTable");
    // studentTable.deleteRow(Number(document.getElementById(data).id) + 1);

    updateTotals();
    //console.log(document.getElementById('destination').rows[1].cells[0].childElementCount);
}

function dropsibling(ev) {
    ev.preventDefault();
    ev.stopPropagation();
    var data = ev.dataTransfer.getData("text/html");
    //console.log(ev.target.parentNode);
    ev.target.parentNode.appendChild(document.getElementById(data));
    document.getElementById(data).setAttribute("class","");
    console.log(document.getElementById(data).id);
    studentTable = document.getElementById("studentTable");
    // studentTable.deleteRow(Number(document.getElementById(data).id) + 1);
    updateTotals();
}

function addstudents(students){
  studentTable = document.getElementById("studentTable");
  var lastRowIndex = studentTable.rows.length-1;
  // console.log(lastRowIndex);
  // console.log(lastRowIndex);
  // if (lastRowIndex > 0){
  //   console.log(studentTable.rows.item(lastRowIndex).cells.length);
  // }
  // console.log(students[students.length - 1]);

  for (var student in students){
    // if (students[student] == undefined){
    //
    // }
    var tr = document.createElement("tr");
    var td = document.createElement("td");
    var div = document.createElement("div");
    var txt = document.createTextNode(students[student]);
    div.setAttribute('draggable', true);
    div.setAttribute('ondragstart','drag(event)');
    div.setAttribute('ondrop','return true');
    div.setAttribute('ondrop','dropsibling(event)');
    div.setAttribute('ondragover','allowDrop(event)');
    div.setAttribute('class','undecided');
    div.id = student;
    div.appendChild(txt);
    td.appendChild(div);
    tr.appendChild(td);
    studentTable.appendChild(tr);
  }
}
window.onload = function(){
  addstudents(students);
  countUndecided();
  }
</script>
</head>
<body>
<table id="destination" class="blueTable">
  <tr id="choices">
    <th>Choice 1</th>
    <th>Choice 2</th>
    <th>PBJ</th>
    <th>Salad Bar</th>
    <th>Cold Lunch</th>
  </tr>
  <tr>
    <td id="1,1" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,1" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,1" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,1" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,1" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="t1">0</td>
    <td id="t2">0</td>
    <td id="t3">0</td> </td>
    <td id="t4">0</td>
    <td id="t5">0</td>
  </tr>
  <!-- <tr>
    <td id="1,3" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,3" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,3" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,3" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,3" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,3" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="1,4" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,4" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,4" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,4" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,4" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,4" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="1,5" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,5" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,5" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,5" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,5" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,5" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="1,6" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,6" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,6" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,6" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,6" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,6" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="1,7" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,7" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,7" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,7" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,7" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,7" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="1,8" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,8" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,8" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,8" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,8" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,8" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="1,9" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,9" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,9" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,9" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,9" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,9" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr>
  <tr>
    <td id="1,10" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="2,10" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="3,10" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="4,10" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="5,10" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
    <td id="6,10" ondrop="drop(event)" ondragover="allowDrop(event)"> </td>
  </tr> -->
</table>
<table id="studentTable" border="1">
  <tr><th>Undecided: <span id="undecided"></span></th></tr>
</table>
</body>
</html>
